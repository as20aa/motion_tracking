#include "robot_driver.h"
#include "reg51.h"



void right_leg(int num[8])
{
	//先做数据修正
	num[5]=300-num[5];
	if(num[5]<500)
		num[5]=500;
	if(num[5]>2500)
		num[5]=2500;
	num[4]=1800-0.7*(1250-num[5]);
	if(num[4]<500)
		num[4]=500;
	if(num[4]>2500)
		num[4]=2500;
	//右脚驱动程序
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0x14;
	while(!TI);TI=0;
	SBUF=0X03;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
	SBUF=0XF4;
	while(!TI);TI=0;
	SBUF=0X01;
	while(!TI);TI=0;
	SBUF=0X09;
	while(!TI);TI=0;
	SBUF=0XDC;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
	SBUF=0X0A;//控制10号舵机
	while(!TI);TI=0;
	SBUF=num[4]&0XFF;//4号陀螺仪低八位
	while(!TI);TI=0;
	SBUF=(num[4]>>8);//4号陀螺仪高八位
	while(!TI);TI=0;
	SBUF=0X0B;
	while(!TI);TI=0;
	SBUF=0XDC;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
	SBUF=0X0C;//控制12号舵机
	while(!TI);TI=0;
	SBUF=num[5]&0xff;//5号陀螺仪低八位
	while(!TI);TI=0;
	SBUF=(num[5]>>8);//5号陀螺仪高八位
	while(!TI);TI=0;
	SBUF=0X0D;
	while(!TI);TI=0;
	SBUF=0XAA;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
}
void left_leg(int num[8])
{
	//先做数据修正
	num[1]=num[1]+2700;
	if(num[1]<500)
		num[1]=500;
	if(num[1]>2500)
		num[1]=2500;
	num[0]=0.7*num[1]-10;
	if(num[0]<500)
		num[0]=500;
	if(num[0]>2500)
		num[0]=2500;
	//左脚驱动程序
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0x14;
	while(!TI);TI=0;
	SBUF=0X03;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
	SBUF=0XF4;
	while(!TI);TI=0;
	SBUF=0X01;
	while(!TI);TI=0;
	SBUF=0X01;
	while(!TI);TI=0;
	SBUF=0XDC;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
	SBUF=0X02;//控制2号舵机
	while(!TI);TI=0;
	SBUF=num[0]&0XFF;//4号陀螺仪低八位
	while(!TI);TI=0;
	SBUF=(num[0]>>8);//4号陀螺仪高八位
	while(!TI);TI=0;
	SBUF=0X03;
	while(!TI);TI=0;
	SBUF=0XDC;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
	SBUF=0X04;//控制4号舵机
	while(!TI);TI=0;
	SBUF=num[1]&0xff;//5号陀螺仪低八位
	while(!TI);TI=0;
	SBUF=(num[1]>>8);//5号陀螺仪高八位
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
	SBUF=0XDC;
	while(!TI);TI=0;
	SBUF=0X05;
	while(!TI);TI=0;
}
void left_hand(int num[8])
{
	//先做数据修正
	num[3]=1350-num[3];
	if(num[3]<500)
		num[3]=500;
	if(num[3]>2500)
		num[3]=2500;
	num[2]=3050-num[2]-num[3];
	if(num[2]<500)
		num[2]=500;
	if(num[2]>2500)
		num[2]=2500;
	//左手驱动程序
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0X0B;
	while(!TI);TI=0;
	SBUF=0X03;
	while(!TI);TI=0;
	SBUF=0X02;
	while(!TI);TI=0;
	SBUF=0XF4;
	while(!TI);TI=0;
	SBUF=0X01;
	while(!TI);TI=0;
	SBUF=0X06;
	while(!TI);TI=0;
	SBUF=num[2]&0xff;
	while(!TI);TI=0;
	SBUF=(num[2]>>8);
	while(!TI);TI=0;
	SBUF=0X07;
	while(!TI);TI=0;
	SBUF=num[3]&0xff;
	while(!TI);TI=0;
	SBUF=(num[3]>>8);
	while(!TI);TI=0;
}
void right_hand(int num[8])
{
	//先做数据修正
	num[7]=num[7]+1650;
	if(num[7]<500)
		num[7]=500;
	if(num[7]>2500)
		num[7]=2500;
	num[6]=2000+num[6]-num[7];
	if(num[6]<500)
		num[6]=500;
	if(num[6]>2500)
		num[6]=2500;
	//右手驱动程序
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0X55;
	while(!TI);TI=0;
	SBUF=0X0B;
	while(!TI);TI=0;
	SBUF=0X03;
	while(!TI);TI=0;
	SBUF=0X02;
	while(!TI);TI=0;
	SBUF=0XF4;
	while(!TI);TI=0;
	SBUF=0X01;
	while(!TI);TI=0;
	SBUF=0X0E;
	while(!TI);TI=0;
	SBUF=num[6]&0xff;
	while(!TI);TI=0;
	SBUF=(num[6]>>8);
	while(!TI);TI=0;
	SBUF=0X0F;
	while(!TI);TI=0;
	SBUF=num[7]&0xff;
	while(!TI);TI=0;
	SBUF=(num[7]>>8);
	while(!TI);TI=0;
}
